clc
clear all
%% HW4d(i)
% hanging wall on soil site
M=6.5;
R=50;
T=[0.01 0.06 0.09 0.10 0.20 0.30 0.40 0.50 0.60 0.75 1.0 ...
    1.5 2.0 3.0 5.0];
logT=log10(T);
c1=[-3.008 -1.994 -1.408 -1.508 -3.226 -4.050 -5.293 -6.307...
    -7.209 -8.309 -9.868 -11.216 -12.806 -13.886 -14.606];
c2=[0.905 0.809 0.765 0.785 0.870 0.999 1.165 1.291 1.395...
    1.509 1.691 1.789 2.005 2.099 2.160];
c3=[-1.451 -1.500 -1.551 -1.551 -1.211 -1.205 -1.167 -1.134...
    -1.099 -1.044 -1.004 -0.965 -0.975 -1.077 -1.114];
c4=[0.110 0.251 0.280 0.280 0.045 0.030 0.011 0.0042 0.0016...
    0.0006 0.0004 0.0003 0.0005 0.0004 0.0004];
c5=[0.638 0.518 0.510 0.500 0.708 0.788 0.958 1.118 1.258 ...
    1.408 1.485 1.522 1.528 1.548 1.562];
lnsa=c1+M*c2+c3.*log(R+c4.*exp(M*c5));
sa=exp(lnsa);
logsa=log10(sa);

% footwall on soil site
C1=[-3.306 -1.896 -1.256 -1.306 -3.310 -4.880 -5.628 -6.284...
    -7.252 -8.355 -9.860 -11.750 -12.827 -13.795 -14.256];
C2=[0.937 0.977 0.907 0.907 0.957 1.219 1.239 1.311 1.429...
    1.536 1.692 1.919 2.025 2.069 2.120];
C3=[-1.454 -1.744 -1.754 -1.734 -1.291 -1.294 -1.181...
    -1.160 -1.128 -1.065 -0.995 -0.997 -0.996 -0.989 -1.144];
C4=[0.100 0.140 0.151 0.151 0.100 0.031 0.0122 0.0057 0.0025...
    0.0008 0.0005 0.0005 0.0005 0.0005 0.0007];
C5=[0.670 0.720 0.720 0.710 0.700 0.910 1.020 1.130 1.260...
    1.420 1.504 1.544 1.536 1.490 1.480];
LnSA=C1+M*C2+C3.*log(R+C4.*exp(M*C5));
SA=exp(LnSA);
logSA=log10(SA);
figure
hold on % natural log
plot(T,lnsa,'r:')
plot(T,LnSA,'b-') %capital is for footwall
legend('hanging wall','foot wall')
xlabel('T(s)')
ylabel('ln(spectrum acceleration)')
figure
hold on % original uni
plot(T,sa,'r:')
plot(T,SA,'b-')
legend('hanging wall','foot wall')
xlabel('T(s)')
ylabel('spectrum acceleration(g)')
figure
hold on % log unit
semilogx(T,sa,'r:')
semilogx(T,SA,'b-')
legend('hanging wall','foot wall')
xlabel('T(s)')
ylabel('log(spectrum acceleration)')
